#+
sweet_t <- function( x, 
                     y, 
                     z,
                     t0_par,
                     gamma_par,
                     a_par,
                     h0_par,
                     h1i_par,
                     lscale) {
#------------------------------------------------------------------------------
  return( tvertprof_Frei( z = z,
                          t0 = mvn_sim( x = x,
                                        y = y,
                                        mean  = t0_par[1], 
                                        stdev = t0_par[2], 
                                        corr_fun_type = "gaussian",
                                        length_scale  = lscale),
                          gamma = mvn_sim( x = x,
                                           y = y,
                                           mean  = gamma_par[1], 
                                           stdev = gamma_par[2], 
                                           corr_fun_type = "gaussian",
                                           length_scale  = lscale),
                          a = mvn_sim( x = x,
                                       y = y,
                                       mean  = a_par[1], 
                                       stdev = a_par[2], 
                                       corr_fun_type = "gaussian",
                                       length_scale  = lscale),
                          h0 = mvn_sim( x = x,
                                        y = y,
                                        mean  = h0_par[1], 
                                        stdev = h0_par[2], 
                                        corr_fun_type = "gaussian",
                                        length_scale  = lscale),
                          h1i = max( mvn_sim( x = x,
                                              y = y,
                                              mean  = h1i_par[1], 
                                              stdev = h1i_par[2], 
                                              corr_fun_type = "gaussian",
                                              length_scale  = lscale), 
                                     rep( 0, length(x)))) )
}
